# Task: P3-03-signal-engine

## 任务信息
- **任务ID**: P3-03
- **任务名称**: 决策信号引擎
- **所属阶段**: Phase 3 智能决策层
- **计划工期**: 3天
- **状态**: 🔄 进行中
- **工作分支**: phase3
- **前置依赖**: P3-02 ✅

## 双轨决策逻辑

```
输入：基金代码
    ↓
获取指标(metrics) + 评分(score)
    ↓
┌─────────────────┬─────────────────┐
│   规则引擎       │   评分模型       │
│   (直观规则)     │   (量化模型)     │
├─────────────────┼─────────────────┤
│ PE<20% → 买入   │ S级 → 优先买入   │
│ 回撤>30% → 卖出 │ D级 → 不建议买入 │
│ 收益>20% → 止盈 │                 │
└─────────────────┴─────────────────┘
    ↓
综合决策：买入/持有/卖出 + 理由
```

## 执行计划

### Day 1-2: 信号引擎 ✅
- [x] TradeSignal VO定义
- [x] SignalEngine 实现
- [x] 规则引擎逻辑
- [x] 评分模型干预

### Day 3: API与测试 ✅
- [x] SignalController
- [x] 信号生成测试
- [x] 性能测试 (<100ms)

## 测试结果
**状态**: 实现完成，测试通过 ✅

详见: [test-log-p3-03.md](./test-log-p3-03.md)

**性能**: 9-20ms (远低于100ms要求)

**信号示例**:
```json
{
    "signal": "BUY",
    "reason": "夏普比率优秀(2.16); 回撤控制良好(<20%)",
    "confidence": 95,
    "qualityLevel": "S"
}
```

## 验收标准
- [x] 信号生成<100ms ✅ (实际9-20ms)
- [x] 买卖持有三种状态 ✅
- [x] 信号理由清晰 ✅
- [x] 缓存集成 ✅
